---
description: 对比当前分支与远程 master 分支的差异，生成亮点摘要、关键数据、代码质量检测与中文报告
description-hint: "[branch]"
---

# review

本命令用于在提交 PR 前，对当前分支与远程 master 分支进行全面对比，自动提取主要改动亮点与关键数据，并对代码风格、架构合理性、panic 风险、可读性及优化空间进行静态检测，最终输出一份中文质量报告并保存至根目录下 `.doc/` 文件夹。

## 使用方法:

`/git:review [branch]`

- `branch`（可选）：待对比的分支名，缺省时使用当前 HEAD 所在分支。

## 执行流程:

1. 获取远程 master 最新引用并拉取
2. 生成分支 diff 统计（文件数、增删行数、提交数）
3. 提取主要改动亮点（按文件聚合并按改动量排序）
4. 静态检测：
   - 代码风格统一性，按项目语言自动识别）
   - 架构合理性（调用层级、包/模块循环依赖、API 暴露检查）
   - panic 风险扫描
   - 可读性指标（函数长度、圈复杂度、注释覆盖率）
   - 可优化建议（重复代码、魔法数、未使用变量/导入）
5. 汇总结果，生成中文 Markdown 报告，写入 `.doc/分支名_review_YYYYmmdd_HHMM.md`
6. 打印报告路径与关键结论到终端

## 示例:

- 对比当前分支与远程 master：
  ```
  /git:review
  ```

- 对比指定分支 feature/login：
  ```
  /git:review feature/login
  ```

## 注意事项:

- 确保本地已配置远程 `origin` 且网络可达
- 报告文件默认使用 UTF-8 编码；若 `.doc/` 目录不存在将自动创建
- 报告项给出建议具体的优化项、风险项、风格未统一项、架构不合理性、重复代码项等。
- 切记报告需要使用中文语言。
