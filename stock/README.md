# Stock MCP Server

ä¸€ä¸ªåŸºäº MCP (Model Context Protocol) çš„è‚¡ç¥¨é‡‘èæ•°æ®æœåŠ¡ï¼Œä¸º AI å¤§æ¨¡å‹æä¾›ä¸­å›½è‚¡å¸‚æ•°æ®æŸ¥è¯¢èƒ½åŠ›ã€‚

## é¡¹ç›®ç®€ä»‹

æœ¬é¡¹ç›®ä½¿ç”¨ `akshare` åº“ä½œä¸ºæ•°æ®æºï¼Œé€šè¿‡ MCP åè®®ä¸º AI åº”ç”¨æä¾›æ ‡å‡†åŒ–çš„è‚¡ç¥¨æ•°æ®æ¥å£ã€‚æ”¯æŒå†å²è¡Œæƒ…æŸ¥è¯¢ã€åˆ†æ—¶æ•°æ®è·å–ç­‰æ ¸å¿ƒåŠŸèƒ½ï¼Œå¸®åŠ©æ„å»ºå¯ç»„åˆã€å®‰å…¨å’Œå¯æ‰©å±•çš„ AI é‡‘èå·¥ä½œæµã€‚

## åŠŸèƒ½ç‰¹æ€§

### æ ¸å¿ƒåŠŸèƒ½

1. **å†å²è¡Œæƒ…æŸ¥è¯¢** (`get_stock_history`)
   - è·å–æŒ‡å®šè‚¡ç¥¨çš„å†å²äº¤æ˜“æ•°æ®
   - æ”¯æŒæ—¥/å‘¨/æœˆé¢‘ç‡
   - æ”¯æŒå‰å¤æƒ/åå¤æƒ
   - è¿”å›ï¼šæ—¥æœŸã€å¼€ç›˜ä»·ã€æ”¶ç›˜ä»·ã€æœ€é«˜ä»·ã€æœ€ä½ä»·ã€æˆäº¤é‡ã€æˆäº¤é¢ã€æ¶¨è·Œå¹…ç­‰

2. **åˆ†æ—¶æ•°æ®æŸ¥è¯¢** (`get_stock_intraday`)
   - è·å–è‚¡ç¥¨åˆ†æ—¶äº¤æ˜“æ•°æ®
   - é»˜è®¤60åˆ†é’Ÿé—´éš”
   - æ”¯æŒ1/5/15/30/60åˆ†é’Ÿçº§åˆ«
   - è¿”å›ï¼šæ—¶é—´ã€å¼€ç›˜ä»·ã€æ”¶ç›˜ä»·ã€æœ€é«˜ä»·ã€æœ€ä½ä»·ã€æˆäº¤é‡ã€æˆäº¤é¢ã€å‡ä»·

### æ‰©å±•åŠŸèƒ½

3. **è¿‘æœŸå†å²è¡Œæƒ…** (`get_recent_history`)
   - å¿«é€Ÿè·å–è¿‘20å¤©çš„å†å²è¡Œæƒ…æ•°æ®
   - ä¾¿äºå¿«é€Ÿäº†è§£è‚¡ç¥¨è¿‘æœŸèµ°åŠ¿
   - åŒ…å«ç®€å•çš„è¶‹åŠ¿åˆ†æå’Œæˆäº¤é‡å¯¹æ¯”

4. **è‚¡ç¥¨åŸºæœ¬ä¿¡æ¯** (`get_stock_info`)
   - è·å–è‚¡ç¥¨è¯¦ç»†åŸºæœ¬ä¿¡æ¯
   - åŒ…å«è‚¡ç¥¨åç§°ã€ä»£ç ã€æœ€æ–°ä»·æ ¼ã€æ€»è‚¡æœ¬ã€æµé€šè‚¡
   - æ€»å¸‚å€¼ã€æµé€šå¸‚å€¼ã€æ‰€å±è¡Œä¸šã€ä¸Šå¸‚æ—¶é—´ç­‰

5. **ç­¹ç åˆ†å¸ƒåˆ†æ** (`get_stock_chip_distribution`)
   - è·å–è‚¡ç¥¨ç­¹ç åˆ†å¸ƒæ•°æ®ï¼ˆè¿‘90ä¸ªäº¤æ˜“æ—¥ï¼‰
   - åŒ…å«è·åˆ©æ¯”ä¾‹ã€å¹³å‡æˆæœ¬ã€æˆæœ¬åˆ†å¸ƒåŒºé—´
   - 90%/70%é›†ä¸­åº¦åˆ†æã€è¶‹åŠ¿å˜åŒ–åˆ†æ

6. **è‚¡ç¥¨ä»£ç æŸ¥è¯¢** (`search_stock_code`)
   - è‚¡ç¥¨ä»£ç å’Œåç§°åŒå‘æŸ¥è¯¢
   - æ”¯æŒç²¾ç¡®åŒ¹é…å’Œæ¨¡ç³Šæœç´¢
   - è‡ªåŠ¨è¯†åˆ«æŸ¥è¯¢ç±»å‹ï¼ˆä»£ç /åç§°ï¼‰

### å¸‚åœºåˆ†æåŠŸèƒ½

7. **è‚¡ç¥¨çƒ­åº¦æ’è¡Œ** (`get_stock_hot_rank`)
   - è·å–ä¸œæ–¹è´¢å¯Œè‚¡ç¥¨äººæ°”æ’è¡Œæ¦œ
   - åŒ…å«çƒ­åº¦å€¼ã€ä»·æ ¼ã€æ¶¨è·Œå¹…ç­‰ä¿¡æ¯
   - åæ˜ å¸‚åœºå…³æ³¨åº¦å’ŒæŠ•èµ„è€…æƒ…ç»ª

8. **ä¸ªè‚¡èµ„é‡‘æµå‘** (`get_individual_fund_flow`)
   - æ”¯æŒå³æ—¶å’Œå¤šæ—¥æ’è¡Œæ•°æ®
   - ä¸»åŠ›ã€è¶…å¤§å•ã€å¤§å•èµ„é‡‘æµå‘åˆ†æ
   - å¸®åŠ©åˆ¤æ–­èµ„é‡‘åŠ¨å‘å’Œå¸‚åœºè¶‹åŠ¿

9. **æ¦‚å¿µèµ„é‡‘æµå‘** (`get_concept_fund_flow`)
   - æ¦‚å¿µæ¿å—èµ„é‡‘æµå‘æ’è¡Œ
   - åŒ…å«æ¦‚å¿µæŒ‡æ•°ã€å‡€æµå…¥ã€é¢†æ¶¨è‚¡
   - æŠŠæ¡å¸‚åœºçƒ­ç‚¹å’ŒæŠ•èµ„ä¸»é¢˜

10. **è¡Œä¸šèµ„é‡‘æµå‘** (`get_industry_fund_flow`)
    - è¡Œä¸šæ¿å—èµ„é‡‘æµå‘åˆ†æ
    - æ”¯æŒå¤šæ—¶é—´å‘¨æœŸæ’è¡Œæ•°æ®
    - åæ˜ äº§ä¸šæŠ•èµ„è¶‹åŠ¿å’Œè½®åŠ¨

11. **è¡Œä¸šæ¿å—æ€»è§ˆ** (`get_industry_board_overview`)
    - å…¨å¸‚åœºè¡Œä¸šæ¿å—ç»¼åˆè¡¨ç°
    - æ¶¨è·Œåˆ†å¸ƒã€èµ„é‡‘æµå‘ã€æˆäº¤æ´»è·ƒåº¦
    - æä¾›å¸‚åœºå…¨æ™¯åˆ†æå’ŒæŠ•èµ„ç­–ç•¥

12. **é¾™è™æ¦œè¯¦æƒ…** (`get_dragon_tiger_list`)
    - è·å–é¾™è™æ¦œè¯¦æƒ…æ•°æ®ï¼Œåæ˜ å¤§é¢äº¤æ˜“æƒ…å†µ
    - æ”¯æŒæŒ‡å®šæ—¥æœŸèŒƒå›´æŸ¥è¯¢ï¼Œé»˜è®¤æœ€è¿‘7å¤©
    - åŒ…å«å‡€ä¹°é¢ã€æˆäº¤é¢å æ¯”ã€ä¸Šæ¦œåŸå› ç­‰
    - æä¾›èµ„é‡‘æµå‘åˆ†æå’ŒæŠ•èµ„é£é™©æç¤º

## æŠ€æœ¯æ ˆ

- **æ•°æ®æº**: [akshare](https://github.com/akfamily/akshare) - ä¸­å›½è‚¡å¸‚æ•°æ®æ¥å£
- **MCP æ¡†æ¶**: [FastMCP](https://github.com/pydantic/fastmcp) - å¿«é€Ÿæ„å»º MCP æœåŠ¡
- **Web æ¡†æ¶**: FastAPI + Uvicorn
- **æ•°æ®å¤„ç†**: pandas

## é¡¹ç›®ç»“æ„

```
stock/
â”œâ”€â”€ README.md                      # é¡¹ç›®è¯´æ˜æ–‡æ¡£
â”œâ”€â”€ USAGE.md                       # è¯¦ç»†ä½¿ç”¨æŒ‡å—
â”œâ”€â”€ stock_mcp_server.py           # ä¸»æœåŠ¡æ–‡ä»¶
â”œâ”€â”€ requirements.txt              # ä¾èµ–æ–‡ä»¶
â”œâ”€â”€ test.py                       # åŸºç¡€åŠŸèƒ½æµ‹è¯•
â”œâ”€â”€ test_mcp_client.py            # MCP å®¢æˆ·ç«¯æµ‹è¯• ğŸ§ª
â”œâ”€â”€ start.sh                      # å¯åŠ¨è„šæœ¬ ğŸš€
â”œâ”€â”€ stop.sh                       # åœæ­¢è„šæœ¬ ğŸ›‘
â”œâ”€â”€ demo.sh                       # æ¼”ç¤ºè„šæœ¬
â”œâ”€â”€ claude_desktop_config.json    # Claude Desktop é…ç½®ç¤ºä¾‹
â”œâ”€â”€ stock_mcp.pid                 # è¿›ç¨‹IDæ–‡ä»¶ï¼ˆè¿è¡Œæ—¶ç”Ÿæˆï¼‰
â”œâ”€â”€ stock_mcp.log                 # æœåŠ¡æ—¥å¿—æ–‡ä»¶ï¼ˆè¿è¡Œæ—¶ç”Ÿæˆï¼‰
â”œâ”€â”€ .augment/
â”‚   â””â”€â”€ rules/
â”‚       â””â”€â”€ rule.md               # å¼€å‘è§„åˆ™æ–‡æ¡£
â””â”€â”€ docs/                         # æ‰©å±•æ–‡æ¡£ç›®å½•
```

## å®‰è£…ä¾èµ–

```bash
pip install akshare fastmcp uvicorn httpx pandas
```

## ä½¿ç”¨æ–¹æ³•

### å¿«é€Ÿå¯åŠ¨ï¼ˆæ¨èï¼‰

ä½¿ç”¨æä¾›çš„å¯åŠ¨è„šæœ¬ï¼Œè‡ªåŠ¨å¤„ç†ä¾èµ–æ£€æŸ¥å’ŒæœåŠ¡ç®¡ç†ï¼š

```bash
# å‰å°è¿è¡Œï¼ˆå¼€å‘è°ƒè¯•ï¼‰
./start.sh

# åå°è¿è¡Œï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰
./start.sh -d

# è‡ªå®šä¹‰ç«¯å£
./start.sh -p 8125

# åœæ­¢æœåŠ¡
./stop.sh

# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
./stop.sh -s
```

### æ‰‹åŠ¨å¯åŠ¨

```bash
# å®‰è£…ä¾èµ–
pip install -r requirements.txt

# å¯åŠ¨æœåŠ¡
python stock_mcp_server.py --port 8124
```

æœåŠ¡å°†åœ¨ `http://localhost:8124` å¯åŠ¨ã€‚

è¯¦ç»†ä½¿ç”¨è¯´æ˜è¯·å‚è€ƒ [USAGE.md](USAGE.md)ã€‚

## MCP å®¢æˆ·ç«¯é›†æˆ

### é…ç½® MCP å®¢æˆ·ç«¯

è‚¡ç¥¨ MCP æœåŠ¡å¯åŠ¨åï¼Œå¯ä»¥é€šè¿‡ MCP å®¢æˆ·ç«¯è¿æ¥ä½¿ç”¨ã€‚ä»¥ä¸‹æ˜¯å¸¸è§çš„é›†æˆæ–¹å¼ï¼š

#### 1. Claude Desktop é›†æˆ

åœ¨ Claude Desktop çš„é…ç½®æ–‡ä»¶ä¸­æ·»åŠ æœåŠ¡é…ç½®ï¼š

**macOS**: `~/Library/Application Support/Claude/claude_desktop_config.json`
**Windows**: `%APPDATA%\Claude\claude_desktop_config.json`

```json
{
  "mcpServers": {
    "stock-data": {
      "command": "python",
      "args": ["/path/to/stock/stock_mcp_server.py", "--port", "8124"],
      "env": {}
    }
  }
}
```

#### 2. HTTP å®¢æˆ·ç«¯é›†æˆ

å¯¹äºæ”¯æŒ HTTP ä¼ è¾“çš„ MCP å®¢æˆ·ç«¯ï¼š

```json
{
  "mcpServers": {
    "stock-data": {
      "transport": "http",
      "url": "http://localhost:8124/mcp"
    }
  }
}
```

#### 3. è‡ªå®šä¹‰å®¢æˆ·ç«¯é›†æˆ

ä½¿ç”¨ MCP SDK è¿æ¥åˆ°æœåŠ¡ï¼š

```python
import asyncio
from mcp.client.session import ClientSession
from mcp.client.stdio import StdioServerParameters
from mcp.client.sse import SseServerParameters

async def connect_to_stock_mcp():
    # HTTP/SSE è¿æ¥æ–¹å¼
    server_params = SseServerParameters(
        url="http://localhost:8124"
    )

    async with ClientSession(server_params) as session:
        # åˆå§‹åŒ–è¿æ¥
        await session.initialize()

        # åˆ—å‡ºå¯ç”¨å·¥å…·
        tools = await session.list_tools()
        print("å¯ç”¨å·¥å…·:", [tool.name for tool in tools.tools])

        # è°ƒç”¨å·¥å…·
        result = await session.call_tool(
            "get_stock_history",
            arguments={
                "symbol": "000001",
                "period": "daily",
                "start_date": "20241201",
                "end_date": "20241213"
            }
        )
        print("æŸ¥è¯¢ç»“æœ:", result.content)

# è¿è¡Œå®¢æˆ·ç«¯
asyncio.run(connect_to_stock_mcp())
```

### å¯ç”¨çš„ MCP å·¥å…·

æœåŠ¡æä¾›ä»¥ä¸‹ MCP å·¥å…·å‡½æ•°ï¼Œå¯é€šè¿‡å®¢æˆ·ç«¯è°ƒç”¨ï¼š

#### 1. `get_stock_history` - å†å²è¡Œæƒ…æŸ¥è¯¢

```json
{
  "name": "get_stock_history",
  "arguments": {
    "symbol": "000001",
    "period": "daily",
    "start_date": "20241201",
    "end_date": "20241213",
    "adjust": ""
  }
}
```

#### 2. `get_stock_intraday` - åˆ†æ—¶æ•°æ®æŸ¥è¯¢

```json
{
  "name": "get_stock_intraday",
  "arguments": {
    "symbol": "000001",
    "date": "20241213",
    "period": "60",
    "adjust": ""
  }
}
```

#### 3. `get_recent_history` - è¿‘æœŸå†å²è¡Œæƒ…

```json
{
  "name": "get_recent_history",
  "arguments": {
    "symbol": "000001",
    "adjust": ""
  }
}
```

#### 4. `get_stock_info` - è‚¡ç¥¨åŸºæœ¬ä¿¡æ¯

```json
{
  "name": "get_stock_info",
  "arguments": {
    "symbol": "000001"
  }
}
```

#### 5. `get_stock_chip_distribution` - ç­¹ç åˆ†å¸ƒåˆ†æ

```json
{
  "name": "get_stock_chip_distribution",
  "arguments": {
    "symbol": "000001",
    "adjust": ""
  }
}
```

#### 6. `search_stock_code` - è‚¡ç¥¨ä»£ç æŸ¥è¯¢

```json
{
  "name": "search_stock_code",
  "arguments": {
    "query": "000001"
  }
}
```

#### 7. `get_stock_hot_rank` - è‚¡ç¥¨çƒ­åº¦æ’è¡Œ

```json
{
  "name": "get_stock_hot_rank",
  "arguments": {}
}
```

#### 8. `get_individual_fund_flow` - ä¸ªè‚¡èµ„é‡‘æµå‘

```json
{
  "name": "get_individual_fund_flow",
  "arguments": {
    "symbol": "å³æ—¶"
  }
}
```

#### 9. `get_concept_fund_flow` - æ¦‚å¿µèµ„é‡‘æµå‘

```json
{
  "name": "get_concept_fund_flow",
  "arguments": {
    "symbol": "å³æ—¶"
  }
}
```

#### 10. `get_industry_fund_flow` - è¡Œä¸šèµ„é‡‘æµå‘

```json
{
  "name": "get_industry_fund_flow",
  "arguments": {
    "symbol": "å³æ—¶"
  }
}
```

#### 11. `get_industry_board_overview` - è¡Œä¸šæ¿å—æ€»è§ˆ

```json
{
  "name": "get_industry_board_overview",
  "arguments": {}
}
```

#### 12. `get_dragon_tiger_list` - é¾™è™æ¦œè¯¦æƒ…

```json
{
  "name": "get_dragon_tiger_list",
  "arguments": {
    "start_date": "20240401",
    "end_date": "20240407"
  }
}
```

### AI åŠ©æ‰‹ä½¿ç”¨ç¤ºä¾‹

å½“ MCP å®¢æˆ·ç«¯ï¼ˆå¦‚ Claudeï¼‰è¿æ¥åˆ°æœåŠ¡åï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨è‡ªç„¶è¯­è¨€æŸ¥è¯¢ï¼š

```
ç”¨æˆ·: å¸®æˆ‘æŸ¥è¯¢å¹³å®‰é“¶è¡Œæœ€è¿‘5å¤©çš„è‚¡ä»·èµ°åŠ¿

AI: æˆ‘æ¥ä¸ºæ‚¨æŸ¥è¯¢å¹³å®‰é“¶è¡Œ(000001)æœ€è¿‘çš„è‚¡ä»·èµ°åŠ¿ã€‚

[è°ƒç”¨ get_recent_history å·¥å…·]

æ ¹æ®æŸ¥è¯¢ç»“æœï¼Œå¹³å®‰é“¶è¡Œæœ€è¿‘5å¤©çš„èµ°åŠ¿å¦‚ä¸‹ï¼š
- æœ€æ–°æ”¶ç›˜ä»·ï¼š10.45å…ƒï¼Œä¸‹è·Œ1.23%
- è¿‘æœŸå‘ˆç°ä¸‹é™è¶‹åŠ¿...
```

```
ç”¨æˆ·: æŸ¥è¯¢è´µå·èŒ…å°ä»Šå¤©çš„60åˆ†é’ŸKçº¿æ•°æ®

AI: æˆ‘æ¥æŸ¥è¯¢è´µå·èŒ…å°(600519)ä»Šå¤©çš„60åˆ†é’ŸKçº¿æ•°æ®ã€‚

[è°ƒç”¨ get_stock_intraday å·¥å…·]

è´µå·èŒ…å°ä»Šæ—¥60åˆ†é’ŸKçº¿æ•°æ®ï¼š
- å¼€ç›˜ä»·ï¼š1650.00å…ƒ
- å½“å‰ä»·ï¼š1645.50å…ƒ
- æˆäº¤é‡ï¼šè¾ƒä¸ºæ´»è·ƒ...
```

```
ç”¨æˆ·: å¸®æˆ‘æŸ¥è¯¢ä¸‡ç§‘Açš„åŸºæœ¬ä¿¡æ¯

AI: æˆ‘æ¥ä¸ºæ‚¨æŸ¥è¯¢ä¸‡ç§‘A(000002)çš„åŸºæœ¬ä¿¡æ¯ã€‚

[è°ƒç”¨ get_stock_info å·¥å…·]

ä¸‡ç§‘AåŸºæœ¬ä¿¡æ¯ï¼š
- è‚¡ç¥¨ç®€ç§°ï¼šä¸‡ç§‘A
- æœ€æ–°ä»·æ ¼ï¼š7.05å…ƒ
- æ€»è‚¡æœ¬ï¼š11,930,709,471è‚¡
- æµé€šå¸‚å€¼ï¼š68,504,397,848å…ƒ
- æ‰€å±è¡Œä¸šï¼šæˆ¿åœ°äº§å¼€å‘
- ä¸Šå¸‚æ—¶é—´ï¼š1991-01-29
```

```
ç”¨æˆ·: å¸®æˆ‘åˆ†æä¸€ä¸‹å¹³å®‰é“¶è¡Œçš„ç­¹ç åˆ†å¸ƒæƒ…å†µ

AI: æˆ‘æ¥ä¸ºæ‚¨åˆ†æå¹³å®‰é“¶è¡Œ(000001)çš„ç­¹ç åˆ†å¸ƒæƒ…å†µã€‚

[è°ƒç”¨ get_stock_chip_distribution å·¥å…·]

å¹³å®‰é“¶è¡Œç­¹ç åˆ†å¸ƒåˆ†æï¼š
- æœ€æ–°è·åˆ©æ¯”ä¾‹ï¼š7.44%ï¼ˆå¤§éƒ¨åˆ†æŠ•èµ„è€…å¤„äºäºæŸçŠ¶æ€ï¼‰
- å¹³å‡æˆæœ¬ï¼š11.25å…ƒ
- 90%æˆæœ¬åˆ†å¸ƒï¼š9.16å…ƒ - 12.56å…ƒï¼ˆåŒºé—´3.40å…ƒï¼‰
- 90%é›†ä¸­åº¦ï¼š0.1733ï¼ˆç­¹ç ç›¸å¯¹é›†ä¸­ï¼‰
- ç­¹ç ä¸»è¦é›†ä¸­åœ¨11å…ƒé™„è¿‘ï¼Œæ”¯æ’‘è¾ƒå¼º
```

```
ç”¨æˆ·: å¸®æˆ‘æŸ¥è¯¢ä¸€ä¸‹è‚¡ç¥¨ä»£ç 000001å¯¹åº”çš„æ˜¯ä»€ä¹ˆè‚¡ç¥¨

AI: æˆ‘æ¥ä¸ºæ‚¨æŸ¥è¯¢è‚¡ç¥¨ä»£ç 000001å¯¹åº”çš„è‚¡ç¥¨ä¿¡æ¯ã€‚

[è°ƒç”¨ search_stock_code å·¥å…·]

æŸ¥è¯¢ç»“æœï¼š
- ä»£ç ï¼š000001
- åç§°ï¼šå¹³å®‰é“¶è¡Œ
- å¸‚åœºï¼šæ·±åœ³è¯åˆ¸äº¤æ˜“æ‰€
- æœ€æ–°ä»·ï¼š10.50å…ƒ
- æ¶¨è·Œå¹…ï¼š+1.23%
```

```
ç”¨æˆ·: æˆ‘æƒ³æ‰¾"å¹³å®‰"ç›¸å…³çš„è‚¡ç¥¨æœ‰å“ªäº›

AI: æˆ‘æ¥ä¸ºæ‚¨æœç´¢åŒ…å«"å¹³å®‰"çš„ç›¸å…³è‚¡ç¥¨ã€‚

[è°ƒç”¨ search_stock_code å·¥å…·]

æ‰¾åˆ° 3 åªç›¸å…³è‚¡ç¥¨ï¼š
1. 000001 å¹³å®‰é“¶è¡Œ (æ·±)
2. 601318 ä¸­å›½å¹³å®‰ (æ²ª)
3. 002142 å®æ³¢é“¶è¡Œ (æ·±)

æ‚¨å¯ä»¥è¿›ä¸€æ­¥æŸ¥è¯¢å…·ä½“è‚¡ç¥¨çš„è¯¦ç»†ä¿¡æ¯ã€‚
```

```
ç”¨æˆ·: å¸®æˆ‘çœ‹çœ‹å½“å‰å¸‚åœºçƒ­ç‚¹æ˜¯ä»€ä¹ˆ

AI: æˆ‘æ¥ä¸ºæ‚¨åˆ†æå½“å‰å¸‚åœºçƒ­ç‚¹æƒ…å†µã€‚

[è°ƒç”¨ get_stock_hot_rank å·¥å…·]
[è°ƒç”¨ get_concept_fund_flow å·¥å…·]

å½“å‰å¸‚åœºçƒ­ç‚¹åˆ†æï¼š

ğŸ“ˆ çƒ­é—¨è‚¡ç¥¨TOP5ï¼š
1. 000001 å¹³å®‰é“¶è¡Œ (äººæ°”å€¼: 12345)
2. 600519 è´µå·èŒ…å° (äººæ°”å€¼: 11234)
...

ğŸ”¥ çƒ­é—¨æ¦‚å¿µæ¿å—ï¼š
1. äººå·¥æ™ºèƒ½: å‡€æµå…¥ 12.34äº¿å…ƒ (+3.45%)
2. æ–°èƒ½æºæ±½è½¦: å‡€æµå…¥ 8.76äº¿å…ƒ (+2.15%)
...

ğŸ’¡ æŠ•èµ„å»ºè®®ï¼šå½“å‰å¸‚åœºå…³æ³¨AIå’Œæ–°èƒ½æºæ¦‚å¿µï¼Œå»ºè®®å…³æ³¨ç›¸å…³é¾™å¤´è‚¡
```

```
ç”¨æˆ·: åˆ†æä¸€ä¸‹ä»Šå¤©çš„èµ„é‡‘æµå‘æƒ…å†µ

AI: æˆ‘æ¥ä¸ºæ‚¨åˆ†æä»Šå¤©çš„å¸‚åœºèµ„é‡‘æµå‘æƒ…å†µã€‚

[è°ƒç”¨ get_individual_fund_flow å·¥å…·]
[è°ƒç”¨ get_industry_fund_flow å·¥å…·]
[è°ƒç”¨ get_industry_board_overview å·¥å…·]

ä»Šæ—¥èµ„é‡‘æµå‘åˆ†æï¼š

ğŸ’° ä¸ªè‚¡èµ„é‡‘æµå‘ï¼š
- ä¸»åŠ›å‡€æµå…¥è‚¡ç¥¨: 1234åª
- ä¸»åŠ›å‡€æµå‡ºè‚¡ç¥¨: 2345åª
- æ•´ä½“èµ„é‡‘æµå‘: å‡€æµå‡º 45.67äº¿å…ƒ

ğŸ­ è¡Œä¸šèµ„é‡‘æµå‘ï¼š
- å‡€æµå…¥è¡Œä¸š: ç”µå­ä¿¡æ¯ (+12.34äº¿)
- å‡€æµå‡ºè¡Œä¸š: æˆ¿åœ°äº§ (-8.76äº¿)

ğŸ“Š å¸‚åœºæƒ…ç»ª: åç©ºï¼Œå»ºè®®è°¨æ…æ“ä½œ
```

```
ç”¨æˆ·: å¸®æˆ‘çœ‹çœ‹æœ€è¿‘æœ‰å“ªäº›è‚¡ç¥¨ä¸Šäº†é¾™è™æ¦œ

AI: æˆ‘æ¥ä¸ºæ‚¨æŸ¥è¯¢æœ€è¿‘çš„é¾™è™æ¦œæƒ…å†µã€‚

[è°ƒç”¨ get_dragon_tiger_list å·¥å…·]

æœ€è¿‘é¾™è™æ¦œæƒ…å†µï¼š

ğŸ“… 2024-04-07 (15åªè‚¡ç¥¨ä¸Šæ¦œ)
1. 000001 å¹³å®‰é“¶è¡Œ: +3.45%ğŸ“ˆ å‡€ä¹°é¢ +1.23äº¿å…ƒ (æ—¥æ¶¨å¹…åç¦»å€¼è¾¾7%)
2. 600519 è´µå·èŒ…å°: -2.15%ğŸ“‰ å‡€ä¹°é¢ -0.87äº¿å…ƒ (æ—¥è·Œå¹…åç¦»å€¼è¾¾7%)
...

ğŸ“Š é¾™è™æ¦œåˆ†æï¼š
- ä¸Šæ¦œè‚¡ç¥¨æ€»æ•°: 45åª
- ä¸Šæ¶¨è‚¡ç¥¨: 28åª (62.2%)
- é¾™è™æ¦œæ€»å‡€ä¹°é¢: +12.34äº¿å…ƒ

ğŸ’¡ æŠ•èµ„æç¤ºï¼šå¤§èµ„é‡‘æ•´ä½“å‘ˆç°å‡€ä¹°å…¥çŠ¶æ€ï¼Œå¸‚åœºæƒ…ç»ªç›¸å¯¹ä¹è§‚
```

### API æ¥å£ç¤ºä¾‹

#### 1. å†å²è¡Œæƒ…æŸ¥è¯¢

```python
# è·å–å¹³å®‰é“¶è¡Œ(000001)è¿‘ä¸€ä¸ªæœˆæ—¥çº¿æ•°æ®
get_stock_history(
    symbol="000001",
    period="daily",
    start_date="20241201",
    end_date="20241231"
)
```

#### 2. åˆ†æ—¶æ•°æ®æŸ¥è¯¢

```python
# è·å–å¹³å®‰é“¶è¡Œ(000001)ä»Šæ—¥60åˆ†é’ŸKçº¿æ•°æ®
get_stock_intraday(
    symbol="000001",
    date="20241213",
    period="60"
)
```

#### 3. è¿‘æœŸå†å²è¡Œæƒ…

```python
# è·å–å¹³å®‰é“¶è¡Œ(000001)è¿‘20å¤©è¡Œæƒ…
get_recent_history(symbol="000001")
```

#### 4. è‚¡ç¥¨åŸºæœ¬ä¿¡æ¯

```python
# è·å–å¹³å®‰é“¶è¡Œ(000001)åŸºæœ¬ä¿¡æ¯
get_stock_info(symbol="000001")
```

#### 5. ç­¹ç åˆ†å¸ƒåˆ†æ

```python
# è·å–å¹³å®‰é“¶è¡Œ(000001)ç­¹ç åˆ†å¸ƒ
get_stock_chip_distribution(symbol="000001", adjust="")
```

#### 6. è‚¡ç¥¨ä»£ç æŸ¥è¯¢

```python
# æ ¹æ®è‚¡ç¥¨ä»£ç æŸ¥è¯¢åç§°
search_stock_code(query="000001")

# æ ¹æ®è‚¡ç¥¨åç§°æŸ¥è¯¢ä»£ç 
search_stock_code(query="å¹³å®‰é“¶è¡Œ")

# æ¨¡ç³ŠæŸ¥è¯¢
search_stock_code(query="å¹³å®‰")
```

#### 7. å¸‚åœºåˆ†æåŠŸèƒ½

```python
# è‚¡ç¥¨çƒ­åº¦æ’è¡Œæ¦œ
get_stock_hot_rank()

# ä¸ªè‚¡èµ„é‡‘æµå‘ï¼ˆå³æ—¶/æ’è¡Œï¼‰
get_individual_fund_flow(symbol="å³æ—¶")
get_individual_fund_flow(symbol="3æ—¥æ’è¡Œ")

# æ¦‚å¿µèµ„é‡‘æµå‘
get_concept_fund_flow(symbol="å³æ—¶")

# è¡Œä¸šèµ„é‡‘æµå‘
get_industry_fund_flow(symbol="å³æ—¶")

# è¡Œä¸šæ¿å—æ€»è§ˆ
get_industry_board_overview()

# é¾™è™æ¦œè¯¦æƒ…ï¼ˆæœ€è¿‘7å¤©ï¼‰
get_dragon_tiger_list()

# é¾™è™æ¦œè¯¦æƒ…ï¼ˆæŒ‡å®šæ—¥æœŸèŒƒå›´ï¼‰
get_dragon_tiger_list(start_date="20240401", end_date="20240407")
```

## æ•°æ®æ ¼å¼è¯´æ˜

### å†å²è¡Œæƒ…æ•°æ®å­—æ®µ

| å­—æ®µå   | ç±»å‹    | è¯´æ˜           |
|----------|---------|----------------|
| æ—¥æœŸ     | string  | äº¤æ˜“æ—¥æœŸ       |
| è‚¡ç¥¨ä»£ç  | string  | è‚¡ç¥¨ä»£ç        |
| å¼€ç›˜     | float   | å¼€ç›˜ä»·(å…ƒ)     |
| æ”¶ç›˜     | float   | æ”¶ç›˜ä»·(å…ƒ)     |
| æœ€é«˜     | float   | æœ€é«˜ä»·(å…ƒ)     |
| æœ€ä½     | float   | æœ€ä½ä»·(å…ƒ)     |
| æˆäº¤é‡   | int     | æˆäº¤é‡(æ‰‹)     |
| æˆäº¤é¢   | float   | æˆäº¤é¢(å…ƒ)     |
| æŒ¯å¹…     | float   | æŒ¯å¹…(%)        |
| æ¶¨è·Œå¹…   | float   | æ¶¨è·Œå¹…(%)      |
| æ¶¨è·Œé¢   | float   | æ¶¨è·Œé¢(å…ƒ)     |
| æ¢æ‰‹ç‡   | float   | æ¢æ‰‹ç‡(%)      |

### åˆ†æ—¶æ•°æ®å­—æ®µ

| å­—æ®µå | ç±»å‹    | è¯´æ˜           |
|--------|---------|----------------|
| æ—¶é—´   | string  | äº¤æ˜“æ—¶é—´       |
| å¼€ç›˜   | float   | å¼€ç›˜ä»·(å…ƒ)     |
| æ”¶ç›˜   | float   | æ”¶ç›˜ä»·(å…ƒ)     |
| æœ€é«˜   | float   | æœ€é«˜ä»·(å…ƒ)     |
| æœ€ä½   | float   | æœ€ä½ä»·(å…ƒ)     |
| æˆäº¤é‡ | float   | æˆäº¤é‡(æ‰‹)     |
| æˆäº¤é¢ | float   | æˆäº¤é¢(å…ƒ)     |
| å‡ä»·   | float   | å‡ä»·(å…ƒ)       |

## è‚¡ç¥¨ä»£ç æ ¼å¼

æ”¯æŒä¸­å›½Aè‚¡è‚¡ç¥¨ä»£ç ï¼Œæ ¼å¼ä¸º6ä½æ•°å­—ï¼š
- ä¸Šæµ·è¯åˆ¸äº¤æ˜“æ‰€ï¼š600xxx, 601xxx, 603xxx, 688xxx
- æ·±åœ³è¯åˆ¸äº¤æ˜“æ‰€ï¼š000xxx, 001xxx, 002xxx, 003xxx, 300xxx

ç¤ºä¾‹ï¼š
- `000001` - å¹³å®‰é“¶è¡Œ
- `000002` - ä¸‡ç§‘A
- `600036` - æ‹›å•†é“¶è¡Œ
- `600519` - è´µå·èŒ…å°

### æµ‹è¯• MCP è¿æ¥

#### ä½¿ç”¨ curl æµ‹è¯•æœåŠ¡

```bash
# å¯åŠ¨æœåŠ¡
./start.sh -d

# æµ‹è¯•æœåŠ¡æ˜¯å¦æ­£å¸¸è¿è¡Œ
curl -X GET http://localhost:8124/health

# æµ‹è¯• MCP å·¥å…·è°ƒç”¨ï¼ˆéœ€è¦ MCP å®¢æˆ·ç«¯ï¼‰
curl -X POST http://localhost:8124/call \
  -H "Content-Type: application/json" \
  -d '{
    "method": "tools/call",
    "params": {
      "name": "get_recent_history",
      "arguments": {
        "symbol": "000001"
      }
    }
  }'
```

#### ä½¿ç”¨ Python MCP å®¢æˆ·ç«¯æµ‹è¯•

```python
# test_mcp_client.py
import asyncio
import json
from mcp.client.session import ClientSession
from mcp.client.sse import SseServerParameters

async def test_stock_mcp():
    """æµ‹è¯•è‚¡ç¥¨ MCP æœåŠ¡"""
    server_params = SseServerParameters(
        url="http://localhost:8124"
    )

    try:
        async with ClientSession(server_params) as session:
            # åˆå§‹åŒ–
            await session.initialize()
            print("âœ… MCP è¿æ¥æˆåŠŸ")

            # åˆ—å‡ºå·¥å…·
            tools_result = await session.list_tools()
            print(f"ğŸ“‹ å¯ç”¨å·¥å…·: {[t.name for t in tools_result.tools]}")

            # æµ‹è¯•è¿‘æœŸå†å²è¡Œæƒ…
            print("\nğŸ” æµ‹è¯•æŸ¥è¯¢å¹³å®‰é“¶è¡Œè¿‘æœŸè¡Œæƒ…...")
            result = await session.call_tool(
                "get_recent_history",
                arguments={"symbol": "000001"}
            )
            print("ğŸ“Š æŸ¥è¯¢ç»“æœ:")
            print(result.content[0].text[:500] + "...")

    except Exception as e:
        print(f"âŒ è¿æ¥å¤±è´¥: {e}")

if __name__ == "__main__":
    asyncio.run(test_stock_mcp())
```

### ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²

#### Docker éƒ¨ç½²

åˆ›å»º `Dockerfile`ï¼š

```dockerfile
FROM python:3.9-slim

WORKDIR /app
COPY requirements.txt .
RUN pip install -r requirements.txt

COPY . .
RUN chmod +x start.sh stop.sh

EXPOSE 8124
CMD ["python", "stock_mcp_server.py", "--host", "0.0.0.0", "--port", "8124"]
```

æ„å»ºå’Œè¿è¡Œï¼š

```bash
# æ„å»ºé•œåƒ
docker build -t stock-mcp .

# è¿è¡Œå®¹å™¨
docker run -d -p 8124:8124 --name stock-mcp-server stock-mcp

# æŸ¥çœ‹æ—¥å¿—
docker logs stock-mcp-server
```

#### åå‘ä»£ç†é…ç½®

ä½¿ç”¨ Nginx ä½œä¸ºåå‘ä»£ç†ï¼š

```nginx
server {
    listen 80;
    server_name your-domain.com;

    location / {
        proxy_pass http://localhost:8124;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;

        # SSE æ”¯æŒ
        proxy_buffering off;
        proxy_cache off;
        proxy_set_header Connection '';
        proxy_http_version 1.1;
        chunked_transfer_encoding off;
    }
}
```

## æ³¨æ„äº‹é¡¹

1. **æ•°æ®å»¶è¿Ÿ**: å†å²æ•°æ®æŒ‰æ—¥é¢‘ç‡æ›´æ–°ï¼Œå½“æ—¥æ”¶ç›˜ä»·è¯·åœ¨æ”¶ç›˜åè·å–
2. **åˆ†æ—¶æ•°æ®é™åˆ¶**: 1åˆ†é’Ÿæ•°æ®åªè¿”å›è¿‘5ä¸ªäº¤æ˜“æ—¥æ•°æ®ä¸”ä¸å¤æƒ
3. **è¯·æ±‚é¢‘ç‡**: å»ºè®®æ§åˆ¶è¯·æ±‚é¢‘ç‡ï¼Œé¿å…å¯¹æ•°æ®æºé€ æˆå‹åŠ›
4. **äº¤æ˜“æ—¶é—´**: åˆ†æ—¶æ•°æ®ä»…åœ¨äº¤æ˜“æ—¶é—´å†…æœ‰æ•ˆï¼ˆ9:30-11:30, 13:00-15:00ï¼‰
5. **MCP å…¼å®¹æ€§**: ç¡®ä¿å®¢æˆ·ç«¯æ”¯æŒ MCP åè®®ç‰ˆæœ¬
6. **ç½‘ç»œå®‰å…¨**: ç”Ÿäº§ç¯å¢ƒå»ºè®®é…ç½® HTTPS å’Œè®¿é—®æ§åˆ¶

## å¼€å‘è®¡åˆ’

- [x] åŸºç¡€é¡¹ç›®ç»“æ„
- [x] å®ç°å†å²è¡Œæƒ…æŸ¥è¯¢æ¥å£
- [x] å®ç°åˆ†æ—¶æ•°æ®æŸ¥è¯¢æ¥å£
- [x] å®ç°è¿‘æœŸå†å²è¡Œæƒ…æ¥å£
- [x] è‚¡ç¥¨åŸºæœ¬ä¿¡æ¯æ¥å£
- [x] ç­¹ç åˆ†å¸ƒåˆ†ææ¥å£
- [x] è‚¡ç¥¨ä»£ç æŸ¥è¯¢æ¥å£
- [x] è‚¡ç¥¨çƒ­åº¦æ’è¡Œæ¥å£
- [x] ä¸ªè‚¡èµ„é‡‘æµå‘æ¥å£
- [x] æ¦‚å¿µèµ„é‡‘æµå‘æ¥å£
- [x] è¡Œä¸šèµ„é‡‘æµå‘æ¥å£
- [x] è¡Œä¸šæ¿å—æ€»è§ˆæ¥å£
- [x] é¾™è™æ¦œè¯¦æƒ…æ¥å£
- [x] æ·»åŠ é”™è¯¯å¤„ç†å’Œæ•°æ®éªŒè¯
- [x] æ·»åŠ åŸºç¡€æµ‹è¯•
- [x] MCP å®¢æˆ·ç«¯é›†æˆè¯´æ˜
- [x] å¯åŠ¨åœæ­¢è„šæœ¬
- [ ] æ€§èƒ½ä¼˜åŒ–å’Œç¼“å­˜æœºåˆ¶
- [ ] å®Œæ•´å•å…ƒæµ‹è¯•è¦†ç›–

## è´¡çŒ®æŒ‡å—

æ¬¢è¿æäº¤ Issue å’Œ Pull Request æ¥æ”¹è¿›é¡¹ç›®ã€‚

## è®¸å¯è¯

MIT License

